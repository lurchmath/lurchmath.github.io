<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Lurch web user interface: expressions.js</title>
    
      <link type="text/css" rel="stylesheet" href="styles/vendor/prism-default.css">
    
    <link type="text/css" rel="stylesheet" href="styles/styles.css">
    
    
    <style>
      :root {
      
      
        --nav-width: 335px;
      
      }
    </style>
    
</head>
<body>

<header class="layout-header">
  
  <h1>
    <a href="./index.html">
      Lurch web user interface
    </a>
  </h1>
  <nav class="layout-nav">
    <ul><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="AlertItem.html">AlertItem</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="BoolSettingMetadata.html">BoolSettingMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BoolSettingMetadata.html#convert">convert</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="BrowserFileSystem.html">BrowserFileSystem</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BrowserFileSystem.html#delete">delete</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BrowserFileSystem.html#has">has</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BrowserFileSystem.html#list">list</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BrowserFileSystem.html#read">read</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BrowserFileSystem.html#write">write</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="ButtonItem.html">ButtonItem</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ButtonItem.html#getElement">getElement</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="CategorySettingMetadata.html">CategorySettingMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="CategorySettingMetadata.html#convert">convert</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="CheckBoxItem.html">CheckBoxItem</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="ColorSettingMetadata.html">ColorSettingMetadata</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="DeclarationType.html">DeclarationType</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeclarationType.html#displayForm">displayForm</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeclarationType.html#documentForm">documentForm</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeclarationType.html#latexForm">latexForm</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeclarationType.html#lurchNotationForm">lurchNotationForm</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeclarationType.html#match">match</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeclarationType.html#toLC">toLC</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeclarationType.html#.allInSettings">allInSettings</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeclarationType.html#.defaultTemplate">defaultTemplate</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeclarationType.html#.existsTemplateFor">existsTemplateFor</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeclarationType.html#.fromTemplate">fromTemplate</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeclarationType.html#.templateToBody">templateToBody</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeclarationType.html#.templateToType">templateToType</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="Dialog.html">Dialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#addItem">addItem</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#close">close</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#currentTabTitle">currentTabTitle</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#querySelector">querySelector</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#querySelectorAll">querySelectorAll</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#reload">reload</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#removeButton">removeButton</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#removeItem">removeItem</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#removeTabs">removeTabs</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#setButtons">setButtons</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#setDefaultFocus">setDefaultFocus</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#setInitialData">setInitialData</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#setOK">setOK</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#setTabs">setTabs</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#show">show</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#showTab">showTab</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#.areYouSure">areYouSure</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#.failure">failure</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#.getTopDialogElement">getTopDialogElement</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#.meaningOfAtom">meaningOfAtom</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#.notify">notify</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Dialog.html#.success">success</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="DialogRow.html">DialogRow</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="DropboxFileSystem.html">DropboxFileSystem</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DropboxFileSystem.html#delete">delete</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DropboxFileSystem.html#has">has</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DropboxFileSystem.html#list">list</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DropboxFileSystem.html#read">read</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DropboxFileSystem.html#write">write</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="FileSystem.html">FileSystem</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#delete">delete</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#documentSaved">documentSaved</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#fileChooserItems">fileChooserItems</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#fileSaverItems">fileSaverItems</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#getName">getName</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#has">has</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#implements">implements</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#list">list</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#read">read</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#write">write</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#.deleteFile">deleteFile</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#.getNamedSubclasses">getNamedSubclasses</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#.getSubclass">getSubclass</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#.getSubclassName">getSubclassName</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#.getSubclasses">getSubclasses</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#.openFile">openFile</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#.registerSubclass">registerSubclass</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#.saveFileAs">saveFileAs</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#.subclassImplements">subclassImplements</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FileSystem.html#.subclassesImplementing">subclassesImplementing</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="FolderContentsItem.html">FolderContentsItem</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FolderContentsItem.html#getPath">getPath</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FolderContentsItem.html#setPath">setPath</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="HTMLItem.html">HTMLItem</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="LabeledGroup.html">LabeledGroup</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="ListItem.html">ListItem</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ListItem.html#setSelectable">setSelectable</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="LongTextInputItem.html">LongTextInputItem</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="LongTextSettingMetadata.html">LongTextSettingMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LongTextSettingMetadata.html#validate">validate</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="LurchDocument.html">LurchDocument</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="LurchDocument.html#bodySettings">bodySettings</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="LurchDocument.html#settingsMetadata">settingsMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LurchDocument.html#clearFileID">clearFileID</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LurchDocument.html#deleteMetadata">deleteMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LurchDocument.html#getDocument">getDocument</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LurchDocument.html#getFileID">getFileID</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LurchDocument.html#getMetadata">getMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LurchDocument.html#getMetadataCategories">getMetadataCategories</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LurchDocument.html#getMetadataKeys">getMetadataKeys</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LurchDocument.html#newDocument">newDocument</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LurchDocument.html#setDocument">setDocument</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LurchDocument.html#setFileID">setFileID</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LurchDocument.html#setMetadata">setMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LurchDocument.html#updateBodyClasses">updateBodyClasses</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LurchDocument.html#.documentParts">documentParts</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="LurchDocument.html#.isDocumentHTML">isDocumentHTML</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="Message.html">Message</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Message.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Message.html#getAllFeedback">getAllFeedback</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Message.html#is">is</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Message.html#send">send</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Message.html#.document">document</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Message.html#.done">done</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Message.html#.error">error</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Message.html#.feedback">feedback</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Message.html#.makeFeedbackPresentable">makeFeedbackPresentable</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Message.html#.progress">progress</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="NoteMetadata.html">NoteMetadata</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="OfflineFileSystem.html">OfflineFileSystem</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="OfflineFileSystem.html#fileChooserItems">fileChooserItems</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="OfflineFileSystem.html#fileSaverItems">fileSaverItems</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="OfflineFileSystem.html#write">write</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="SelectBoxItem.html">SelectBoxItem</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="SettingMetadata.html">SettingMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="SettingMetadata.html#control">control</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="SettingMetadata.html#convert">convert</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="SettingMetadata.html#validate">validate</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="Settings.html">Settings</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Settings.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Settings.html#has">has</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Settings.html#keys">keys</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Settings.html#load">load</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Settings.html#loadHiddenSetting">loadHiddenSetting</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Settings.html#reset">reset</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Settings.html#save">save</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Settings.html#saveHiddenSetting">saveHiddenSetting</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Settings.html#showWarning">showWarning</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Settings.html#userEdit">userEdit</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="SettingsCategoryMetadata.html">SettingsCategoryMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="SettingsCategoryMetadata.html#control">control</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="SettingsCategoryMetadata.html#defaultSettings">defaultSettings</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="SettingsCategoryMetadata.html#keys">keys</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="SettingsCategoryMetadata.html#metadataFor">metadataFor</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="SettingsCategoryMetadata.html#validate">validate</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="SettingsMetadata.html">SettingsMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="SettingsMetadata.html#control">control</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="SettingsMetadata.html#defaultSettings">defaultSettings</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="SettingsMetadata.html#keys">keys</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="SettingsMetadata.html#metadataFor">metadataFor</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="SettingsMetadata.html#validate">validate</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="ShowWarningSettingMetadata.html">ShowWarningSettingMetadata</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="TextInputItem.html">TextInputItem</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="TextSettingMetadata.html">TextSettingMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="TextSettingMetadata.html#validate">validate</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="WebFileSystem.html">WebFileSystem</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="WebFileSystem.html#fileChooserItems">fileChooserItems</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="WebFileSystem.html#fileSaverItems">fileSaverItems</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="WebFileSystem.html#list">list</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="WebFileSystem.html#read">read</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-Atoms.Atom.html">Atom</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#applyValidationMessage">applyValidationMessage</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#contextMenu">contextMenu</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#dataChanged">dataChanged</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#edit">edit</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#editThenInsert">editThenInsert</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#fillChild">fillChild</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#getChild">getChild</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#getHTML">getHTML</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#getHTMLMetadata">getHTMLMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#getHTMLMetadataKeys">getHTMLMetadataKeys</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#getMetadata">getMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#getMetadataKeys">getMetadataKeys</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#getValidationResults">getValidationResults</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#isEditable">isEditable</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#parent">parent</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#removeChild">removeChild</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#removeHTMLMetadata">removeHTMLMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#removeMetadata">removeMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#setHTMLMetadata">setHTMLMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#setHoverText">setHoverText</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#setMetadata">setMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#setValidationResult">setValidationResult</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#toLCs">toLCs</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#toLatex">toLatex</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#update">update</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#wasDeleted">wasDeleted</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#.allElementsIn">allElementsIn</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#.allIn">allIn</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#.create">create</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#.createElement">createElement</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#.findAbove">findAbove</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#.from">from</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#.isAtomElement">isAtomElement</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#.newBlock">newBlock</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#.newInline">newInline</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#.registerSubclass">registerSubclass</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#.simplifiedHTML">simplifiedHTML</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.Atom.html#.unsimplifyDOM">unsimplifyDOM</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-DownloadUpload.UploadItem.html">UploadItem</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-ExpositoryMathAtoms.ExpositoryMath.html">ExpositoryMath</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-ExpositoryMathAtoms.ExpositoryMath.html#edit">edit</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-ExpositoryMathAtoms.ExpositoryMath.html#toEmbed">toEmbed</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-ExpositoryMathAtoms.ExpositoryMath.html#toLatex">toLatex</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-ExpositoryMathAtoms.ExpositoryMath.html#update">update</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-ExpressionAtoms.Expression.html">Expression</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-ExpressionAtoms.Expression.html#contextMenu">contextMenu</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-ExpressionAtoms.Expression.html#edit">edit</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-ExpressionAtoms.Expression.html#toEmbed">toEmbed</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-ExpressionAtoms.Expression.html#toLCs">toLCs</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-ExpressionAtoms.Expression.html#toLatex">toLatex</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-ExpressionAtoms.Expression.html#update">update</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-MathLive.MathItem.html">MathItem</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-MathLive.MathItem.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-MathLive.MathItem.html#setFocusWhenShown">setFocusWhenShown</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-MathLive.MathItem.html#setValue">setValue</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-Shells.Axiom.html">Axiom</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-Shells.Corollary.html">Corollary</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-Shells.Definition.html">Definition</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-Shells.Lemma.html">Lemma</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-Shells.Premise.html">Premise</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-Shells.Preview.html">Preview</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Preview.html#imitate">imitate</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-Shells.Proof.html">Proof</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-Shells.Recall.html">Recall</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-Shells.Rule.html">Rule</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-Shells.Shell.html">Shell</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Shell.html#contextMenu">contextMenu</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Shell.html#edit">edit</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Shell.html#editShellType">editShellType</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Shell.html#finalize">finalize</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Shell.html#getTitle">getTitle</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Shell.html#setSubclass">setSubclass</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Shell.html#setValidationResult">setValidationResult</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Shell.html#toEmbed">toEmbed</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Shell.html#toLCs">toLCs</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Shell.html#toLatex">toLatex</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Shell.html#.accessibles">accessibles</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Shell.html#.createElement">createElement</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Shell.html#.isAccessibleTo">isAccessibleTo</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.Shell.html#.subclassNames">subclassNames</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-Shells.Subproof.html">Subproof</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="module-Shells.Theorem.html">Theorem</a></span></li></ul><ul><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-Atoms.html">Atoms</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-Atoms.html#.className">className</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Atoms.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-AutoComplete.html">AutoComplete</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-AutoComplete.html#.addAutocompleteFunction">addAutocompleteFunction</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-AutoComplete.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-CLI.html">CLI</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-Dependencies.html">Dependencies</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Dependencies.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-DocumentSettings.html">DocumentSettings</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-DocumentSettings.html#.lookup">lookup</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-DocumentSettings.html#.store">store</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-DocumentSettings.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-DownloadUpload.html">DownloadUpload</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-DownloadUpload.html#.downloadFile">downloadFile</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-EmbedListener.html">EmbedListener</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-EmbedListener.html#~install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-EmbedScript.html">EmbedScript</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-Export.html">Export</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Export.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-ExpositoryMathAtoms.html">ExpositoryMathAtoms</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-ExpositoryMathAtoms.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-ExpressionAtoms.html">ExpressionAtoms</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-ExpressionAtoms.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-GoogleDriveUI.html">GoogleDriveUI</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-GoogleDriveUI.html#.install">install</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-GoogleDriveUI.html#~showFileOpenDialog">showFileOpenDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-GoogleDriveUI.html#~showSaveAsDialog">showSaveAsDialog</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-GoogleDriveUI.html#~silentFileSave">silentFileSave</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-GoogleDriveUtilities.html">GoogleDriveUtilities</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-GoogleDriveUtilities.html#.listFilesFromFolder">listFilesFromFolder</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-GoogleDriveUtilities.html#.readFileFromDrive">readFileFromDrive</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-GoogleDriveUtilities.html#.showOpenFilePicker">showOpenFilePicker</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-GoogleDriveUtilities.html#.showSaveFolderPicker">showSaveFolderPicker</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-GoogleDriveUtilities.html#.updateFileInDrive">updateFileInDrive</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-GoogleDriveUtilities.html#.writeNewFileToDrive">writeNewFileToDrive</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-HeaderEditor.html">HeaderEditor</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-HeaderEditor.html#.getHeader">getHeader</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-HeaderEditor.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-HeadlessLurch.html">HeadlessLurch</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-HeadlessLurch.html#.closeApp">closeApp</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-HeadlessLurch.html#.documentAsPDF">documentAsPDF</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-HeadlessLurch.html#.documentHTML">documentHTML</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-HeadlessLurch.html#.isLongForm">isLongForm</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-HeadlessLurch.html#.openApp">openApp</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-HeadlessLurch.html#.openDocument">openDocument</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-HeadlessLurch.html#.validationResults">validationResults</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-ImportFromURL.html">ImportFromURL</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-ImportFromURL.html#.loadFromURL">loadFromURL</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-ImportFromURL.html#.openFileInNewWindow">openFileInNewWindow</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-ImportFromURL.html#.autoOpenLink">autoOpenLink</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-ImportFromURL.html#.loadFromQueryString">loadFromQueryString</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-MathLive.html">MathLive</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-MathLive.html#.inputFormats">inputFormats</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-MathLive.html#.outputFormats">outputFormats</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-MathLive.html#.stylesheet">stylesheet</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-MathLive.html#.getConverter">getConverter</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-Notation.html">Notation</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Notation.html#.addParser">addParser</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Notation.html#.addRepresentation">addRepresentation</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Notation.html#.markNameAsMath">markNameAsMath</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Notation.html#.names">names</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Notation.html#.parse">parse</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Notation.html#.putdownHTML">putdownHTML</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Notation.html#.represent">represent</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Notation.html#.syntaxTreeHTML">syntaxTreeHTML</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Notation.html#.usesMathEditor">usesMathEditor</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-SettingsInstaller.html">SettingsInstaller</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-SettingsInstaller.html#.appSettings">appSettings</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-SettingsInstaller.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-Shells.html">Shells</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Shells.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-Utilities.html">Utilities</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-Utilities.html#.copyHTMLToClipboard">copyHTMLToClipboard</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-Utilities.html#.fullUnindent">fullUnindent</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-Utilities.html#.htmlToImage">htmlToImage</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-Utilities.html#.isEmbedded">isEmbedded</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-Utilities.html#.isOnScreen">isOnScreen</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="module-Utilities.html#.isValidURL">isValidURL</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Utilities.html#.appURL">appURL</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Utilities.html#.copyWithoutPrototype">copyWithoutPrototype</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Utilities.html#.editorForNode">editorForNode</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Utilities.html#.escapeHTML">escapeHTML</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Utilities.html#.escapeLatex">escapeLatex</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Utilities.html#.loadScript">loadScript</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Utilities.html#.loadStylesheet">loadStylesheet</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Utilities.html#.makeAbsoluteURL">makeAbsoluteURL</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Utilities.html#.onlyBefore">onlyBefore</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Utilities.html#.removeScriptTags">removeScriptTags</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Utilities.html#.simpleHTMLTable">simpleHTMLTable</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Utilities.html#.unescapeHTML">unescapeHTML</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-Validation.html">Validation</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="module-Validation.html#.install">install</a></span></li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-ValidationWorker.html">ValidationWorker</a></span></li></ul><ul><li class="nav-heading">Namespaces</li><li class="nav-heading"><span class="nav-item-type type-namespace" title="namespace">N</span><span class="nav-item-name is-namespace"><a href="Lurch.html">Lurch</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Lurch.html#.createApp">createApp</a></span></li></ul><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="global.html#install">install</a></span></li>
  </nav>
</header>


<main class="layout-main  layout-content--source">
  <div class="container">
    <p class="page-kind">source</p>
    <h1 class="page-title">expressions.js</h1>
    



    

<section>
    <article>
        <pre id="source" class="source-page line-numbers"><code class="language-js">
/**
 * This file installs one tool into the user interface, a menu item for
 * inserting an inline atom into the document, one that allows the user to write
 * mathematical expressions and declarations in a variety of editing modes.
 * Beginner mode uses the MathLive editor, which is probably easiest for new
 * users.  Intermediate mode has the greatest UI complexity, including drop-down
 * menus for statements vs. assumptions vs. all types of declarations, and
 * permitting expression input using Lurch notation or the MathLive editor.
 * Advanced mode is a minimalistic dialog in which the user can enter only Lurch
 * notation, and see a preview of it typeset before confirming their edits.
 * 
 * @module ExpressionAtoms
 */

import { Atom } from './atoms.js'
import { lookup } from './document-settings.js'
import {
    Dialog, LongTextInputItem, TextInputItem, CheckBoxItem, SelectBoxItem
} from './dialog.js'
import { parse, represent } from './notation.js'
import { MathItem, getConverter } from './math-live.js'
import { appSettings } from './settings-install.js'
import {
    Expression as LCExpression, Declaration as LCDeclaration
} from './lde-cdn.js'
import { DeclarationType } from './declarations.js'
import { copyHTMLToClipboard } from './utilities.js'

let converter = null

/**
 * Install into a TinyMCE editor instance a new menu item:
 * "Expression," intended for the Insert menu.  It creates an inline atom that
 * can be inserted into the user's document, then initiates editing on it, so
 * that the user can customize it and then confirm or cancel the insertion of it.
 * The inline atom represents a mathematical expression or declaration.
 * 
 * @param {tinymce.Editor} editor the TinyMCE editor instance into which the new
 *   menu item should be installed
 * @function
 */
export const install = editor => {
    getConverter().then( result => converter = result )
    // Define reusable function that initiates the insertion of an expression
    const insertExpression = () => {
        const mode = appSettings.get( 'expression editor type' )
        const atom = Atom.newInline( editor, '',
            mode == 'Beginner' ? {
                type : 'expression',
                latex : '',
                given : false
            } : mode == 'Intermediate' ? {
                type : 'expression',
                contentType : 'Statement',
                latex : '',
                lurchNotation : '',
                symbol : ''
            } : { // mode == 'Advanced'
                type : 'expression',
                lurchNotation : ''
            } )
        atom.update()
        atom.editThenInsert()
    }
    // Install that function as what happens when you use the Insert expression action
    editor.ui.registry.addMenuItem( 'expression', {
        text : 'Expression',
        icon : 'superscript',
        tooltip : 'Insert expression',
        shortcut : 'Meta+E',
        onAction : insertExpression
    } )
}

/**
 * An Atom that represents a mathematical expression or declaration.
 */
export class Expression extends Atom {

    static subclassName = Atom.registerSubclass( 'expression', Expression )

    // Internal use only
    // Redirects the user to beginner, intermediate, or advanced editing mode,
    // with the given explanation presented, returning a promise that resolves
    // or rejects depending on what happens with the corresponding dialog.
    redirectEditMode ( mode, explanation = '' ) {
        return new Promise( ( resolve, reject ) => {
            Dialog.failure(
                this.editor,
                `${explanation}  Redirecting you to ${mode} mode.`,
                `Must edit in ${mode} mode`
            ).then( () => {
                switch ( mode ) {
                    case 'beginner':
                        this.editInBeginnerMode().then( resolve ).catch( reject )
                        break
                    case 'intermediate':
                        this.editInIntermediateMode().then( resolve ).catch( reject )
                        break
                    case 'advanced':
                        this.editInAdvancedMode().then( resolve ).catch( reject )
                        break
                }
            } )
        } )
    }

    // Internal use only
    // Was this expression last edited (and thus is now saved) using the
    // beginner mode of the editor?
    // (The way to tell is that there is no Lurch notation metadata, since only
    // intermediate and advanced modes use that.)
    isInBeginnerMode () {
        return typeof( this.getMetadata( 'lurchNotation' ) ) == 'undefined'
    }

    // Internal use only
    // Was this expression last edited (and thus is now saved) using the
    // intermediate mode of the editor?
    // (The way to tell is that there is a contentType metadata, since only
    // intermediate mode uses that.)
    isInIntermediateMode () {
        return !!this.getMetadata( 'contentType' )
    }

    // Internal use only
    // Was this expression last edited (and thus is now saved) using the
    // advanced mode of the editor?
    // (Easy: neither of the previous two are true)
    isInAdvancedMode () {
        return !this.isInBeginnerMode() &amp;&amp; !this.isInIntermediateMode()
    }

    // Internal use only
    // Does this atom represent a statement?
    // (That is, exactly one LC, which is an Expression-type LC and not a given.)
    isStatement () {
        const LCs = this.toLCs()
        return LCs.length == 1
            &amp;&amp; ( LCs[0] instanceof LCExpression )
            &amp;&amp; !LCs[0].isA( 'given' )
    }

    // Internal use only
    // Does this atom represent an assumption?
    // (That is, exactly one LC, which is an Expression-type LC and a given.)
    isAssumption () {
        const LCs = this.toLCs()
        return LCs.length == 1
            &amp;&amp; ( LCs[0] instanceof LCExpression )
            &amp;&amp; LCs[0].isA( 'given' )
    }

    // Internal use only
    // Does this atom represent a declaration?
    // (That is, exactly one LC, which is a Declaration-type LC.)
    isDeclaration () {
        const LCs = this.toLCs()
        return LCs.length == 1
            &amp;&amp; ( LCs[0] instanceof LCDeclaration )
    }

    // Internal use only
    // Look at the metadata for this atom and try to deduce how to represent it
    // in the data for beginner mode (that is, a single expr-given pair, as an
    // object with just the fields `latex` and `given`).  This throws an error
    // if it's not possible, with a user-readable error message.
    loadBeginnerModeData () {
        if ( this.isInBeginnerMode() ) {
            return {
                latex : this.getMetadata( 'latex' ),
                given : this.getMetadata( 'given' )
            }
        }
        if ( this.isInIntermediateMode() ) {
            if ( this.isDeclaration() )
                throw new Error( 'Declarations cannot be edited in beginner mode.' )
            return {
                latex : this.getMetadata( 'latex' ),
                given : this.isAssumption()
            }
        }
        if ( this.isInAdvancedMode() ) {
            if ( this.isStatement() ) {
                const lurchNotation = this.getMetadata( 'lurchNotation' )
                return {
                    latex : converter( lurchNotation, 'lurch', 'latex' ),
                    given : false
                }
            }
            if ( this.isAssumption() )
                throw new Error( 'Converting assumptions from advanced to beginner mode not yet implemented.' )
            throw new Error( 'This type of content cannot be edited in beginner mode.' )
        }
    }

    // Internal use only
    // Look at the metadata for this atom and try to deduce how to represent it
    // in the data for intermediate mode (that is, an object with the fields
    // `contentType`, `latex`, `lurchNotation`, and `symbol`).  This throws an
    // error if it's not possible, with a user-readable error message.
    loadIntermediateModeData () {
        if ( this.isInBeginnerMode() ) {
            const latex = this.getMetadata( 'latex' )
            return {
                // Phrased the following way so that empty LaTeX => Statement:
                contentType : this.isAssumption() ? 'Assumption' : 'Statement',
                symbol : '',
                latex : latex,
                lurchNotation : converter( latex, 'latex', 'lurch' )
            }
        }
        if ( this.isInIntermediateMode() ) {
            return {
                contentType : this.getMetadata( 'contentType' ),
                symbol : this.getMetadata( 'symbol' ),
                latex : this.getMetadata( 'latex' ),
                lurchNotation : this.getMetadata( 'lurchNotation' )
            }
        }
        if ( this.isInAdvancedMode() ) {
            if ( this.isStatement() ) {
                const lurchNotation = this.getMetadata( 'lurchNotation' )
                return {
                    contentType : 'Statement',
                    symbol : '',
                    latex : converter( lurchNotation, 'lurch', 'latex' ),
                    lurchNotation : lurchNotation
                }
            }
            if ( this.isAssumption() )
                throw new Error( 'Converting assumptions to intermediate mode not yet implemented.' )
            throw new Error( 'This type of content cannot be edited in intermediate mode.' )
        }
    }

    // Internal use only
    // Look at the metadata for this atom and try to deduce how to represent it
    // in the data for advanced mode (that is, just a single string in Lurch
    // notation, though we store it in an object with the `lurchNotation` field,
    // to be future-proof).  This throws an error if it's not possible, with a
    // user-readable error message.
    loadAdvancedModeData () {
        if ( this.isInBeginnerMode() ) {
            const latex = this.getMetadata( 'latex' )
            const lurchNotation = converter( latex, 'latex', 'lurch' )
            const prefix = this.isStatement() ? '' : ':'
            return {
                lurchNotation : prefix + lurchNotation
            }
        }
        if ( this.isInIntermediateMode() ) {
            const contentType = this.getMetadata( 'contentType' )
            if ( contentType == 'Statement' ) return {
                lurchNotation : this.getMetadata( 'lurchNotation' )
            }
            if ( contentType == 'Assumption' ) return {
                lurchNotation : ':' + this.getMetadata( 'lurchNotation' )
            }
            const declType = DeclarationType.fromTemplate( contentType )
            const symbol = this.getMetadata( 'symbol' )
            const lurchNotationForBody = this.getMetadata( 'lurchNotation' )
            return {
                lurchNotation : declType.lurchNotationForm( symbol, lurchNotationForBody )
            }
        }
        if ( this.isInAdvancedMode() ) {
            return {
                lurchNotation : this.getMetadata( 'lurchNotation' )
            }
        }
    }

    // Internal use only
    // Save the given data in the metadata for this atom, in such a way that we
    // would then have isInBeginnerMode() true, and loadBeginnerModeData() would
    // extract this data.
    saveBeginnerModeData ( latex, given ) {
        this.setMetadata( 'latex', latex )
        this.setMetadata( 'given', given )
        this.removeMetadata( 'contentType' )
        this.removeMetadata( 'symbol' )
        this.removeMetadata( 'lurchNotation' )
    }

    // Internal use only
    // Save the given data in the metadata for this atom, in such a way that we
    // would then have isInIntermediateMode() true, and loadIntermediateModeData()
    // would extract this data.
    saveIntermediateModeData ( contentType, symbol, latex, lurchNotation ) {
        this.setMetadata( 'contentType', contentType )
        this.setMetadata( 'symbol', symbol )
        this.setMetadata( 'latex', latex )
        this.setMetadata( 'lurchNotation', lurchNotation )
        this.removeMetadata( 'given' )
    }

    // Internal use only
    // Save the given data in the metadata for this atom, in such a way that we
    // would then have isInAdvancedMode() true, and loadAdvancedModeData() would
    // extract this data.
    saveAdvancedModeData ( lurchNotation ) {
        this.setMetadata( 'lurchNotation', lurchNotation )
        this.removeMetadata( 'given' )
        this.removeMetadata( 'contentType' )
        this.removeMetadata( 'symbol' )
        this.removeMetadata( 'latex' )
    }

    // Internal use only.
    // Used by edit() if the user's settings are in beginner mode.
    editInBeginnerMode () {
        // Ensure that we can do this in beginner mode; if not, switch to another
        // mode instead.
        let loadedData
        try {
            loadedData = this.loadBeginnerModeData()
        } catch ( e ) {
            try {
                this.loadIntermediateModeData()
                return this.redirectEditMode( 'intermediate', e.message )
            } catch ( e ) {
                return this.redirectEditMode( 'advanced', e.message )
            }
        }
        // set up dialog contents
        const dialog = new Dialog( 'Edit math', this.editor )
        const mathLiveInput = new MathItem( 'latex', '' )
        mathLiveInput.setFocusWhenShown( true )
        dialog.addItem( mathLiveInput )
        dialog.addItem( new CheckBoxItem( 'given', 'Assumption', false ) )
        // initialize dialog with data from the atom
        dialog.setInitialData( {
            latex : loadedData.latex,
            given : loadedData.given
        } )
        // utilities used below
        const convertToLurchNotation = () => {
            try {
                return converter( dialog.get( 'latex' ), 'latex', 'lurch' )
            } catch {
                return null
            }
        }
        const latexIsValid = () => {
            try {
                const lurchNotation = convertToLurchNotation()
                if ( lurchNotation === null ) return null
                const LCs = parse( lurchNotation, 'lurchNotation' )
                return ( LCs.length == 1 ) &amp;&amp; ( LCs[0] instanceof LCExpression )
            } catch {
                return null
            }
        }
        dialog.onChange = () =>
            dialog.dialog.setEnabled( 'OK', latexIsValid() )
        // Show it and if they accept any changes, apply them to the atom.
        const result = dialog.show().then( userHitOK => {
            if ( !userHitOK || !latexIsValid() ) return false
            this.saveBeginnerModeData( dialog.get( 'latex' ), dialog.get( 'given' ) )
            this.update()
            return true
        } )
        dialog.dialog.setEnabled( 'OK', latexIsValid() )
        return result
    }

    // Internal use only.
    // Used by edit() if the user's settings are in intermediate mode.
    editInIntermediateMode () {
        // Ensure that we can do this in intermediate mode; if not, switch to
        // advanced mode instead.
        let loadedData
        try {
            loadedData = this.loadIntermediateModeData()
        } catch ( e ) {
            return this.redirectEditMode( 'advanced', e.message )
        }
        // set up dialog contents
        const dialog = new Dialog( 'Edit math', this.editor )
        dialog.addItem( new SelectBoxItem( 'contentType',
            'Type of mathematical content',
            [
                'Statement',
                'Assumption',
                ...DeclarationType.allInSettings( true ).map( dt =>
                    dt.template )
            ]
        ) )
        const symbolInput = new TextInputItem( 'symbol',
            'Name of variable or constant', '' )
        dialog.addItem( symbolInput )
        const lurchInput = new TextInputItem( 'lurchNotation',
            'Statement in plain text', '' )
        dialog.addItem( lurchInput )
        const mathLiveInput = new MathItem( 'latex',
            'Statement in standard notation' )
        dialog.addItem( mathLiveInput )
        const mathLivePreview = new MathItem( 'preview', 'Preview of content' )
        mathLivePreview.finishSetup = () => {
            mathLivePreview.mathLiveEditor.readOnly = true
            mathLivePreview.mathLiveEditor.style.border = 0
        }
        dialog.addItem( mathLivePreview )
        // create functions for manipulating the contents of the dialog
        const showGroup = ( element, visible ) => {
            const group = element?.parentNode
            if ( group ) group.style.display = visible ? '' : 'none'
        }
        const symbolElement = () => dialog.querySelector( 'input[type="text"]' )
        const showSymbolGroup = visible => showGroup( symbolElement(), visible )
        const expressionTextElement = () => dialog.querySelectorAll( 'input[type="text"]' )[1]
        const expressionLatexElement = () => dialog.querySelector( '#math-latex' )
        const showExpressionGroups = visible => {
            showGroup( expressionTextElement(), visible )
            showGroup( expressionLatexElement(), visible )
        }
        const expressionGroupsVisible = () =>
            expressionTextElement()?.parentNode?.style?.display != 'none'
        const showControlsForContentType = contentType => {
            showSymbolGroup( contentType != 'Statement'
                &amp;&amp; contentType != 'Assumption' )
            showExpressionGroups( contentType == 'Statement'
                || contentType == 'Assumption'
                || DeclarationType.templateToBody( contentType ) != 'none' )
        }
        // initialize dialog with data from the atom
        dialog.setInitialData( {
            lurchNotation : loadedData.lurchNotation,
            latex : loadedData.latex,
            symbol : loadedData.symbol || '',
            contentType : loadedData.contentType
        } )
        // place the cursor where it belongs
        if ( loadedData.contentType != 'Statement'
          &amp;&amp; loadedData.contentType != 'Assumption' )
            dialog.setDefaultFocus( 'symbol' )
        else if ( lookup( this.editor, 'notation' ) == 'latex' )
            mathLiveInput.setFocusWhenShown( true )
        else
            dialog.setDefaultFocus( 'lurchNotation' )
        // utilities used below
        const convertToLatex = () => {
            const lurchNotation = dialog.get( 'lurchNotation' )
            if ( lurchNotation.trim() == '' ) return ''
            try {
                return converter( lurchNotation, 'lurch', 'latex' )
            } catch {
                return null
            }
        }
        const convertToLurchNotation = () => {
            const latex = dialog.get( 'latex' )
            if ( latex.trim() == '' ) return ''
            try {
                return converter( latex, 'latex', 'lurch' )
            } catch {
                return null
            }
        }
        let expressionIsValid = loadedData.latex.trim() != ''
        const generatePreview = () => {
            // console.log( 'gen prev with',
            //     dialog.get( 'contentType' ),
            //     dialog.get( 'symbol' ),
            //     dialog.get( 'lurchNotation' ),
            //     dialog.get( 'latex' )
            // )
            const contentType = dialog.get( 'contentType' )
            const expressionLatex = convertToLatex()
            if ( contentType == 'Statement' )
                return expressionIsValid ? expressionLatex : null
            if ( contentType == 'Assumption' )
                return expressionIsValid ? `\\text{Assume }${expressionLatex}` : null
            const symbol = dialog.get( 'symbol' )
            if ( `${symbol}`.trim() == '' ) return null
            const declType = DeclarationType.fromTemplate( contentType )
            if ( declType.body != 'none'
              &amp;&amp; ( !expressionIsValid || !expressionLatex ) )
                return null
            const symbolLatex = symbol.length == 1 ? symbol : `\\mathrm{${symbol}}`
            const filled = contentType
                .replace( '[statement]', `$${expressionLatex}$` )
                .replace( '[variable]', `$${symbolLatex}$` )
                .replace( '[constant]', `$${symbolLatex}$` )
            return `\\text{${filled}}`
        }
        // if they edit the Lurch notation or latex, keep them in sync
        let updatesEnabled = false
        setTimeout( () => updatesEnabled = true ) // after dialog populates
        dialog.onChange = ( _, component ) => {
            if ( !updatesEnabled ) return
            updatesEnabled = false // prevent syncing to fixed point/infinity
            if ( expressionGroupsVisible()
              &amp;&amp; ( component.name == 'lurchNotation' || component.name == 'latex' ) ) {
                if ( component.name == 'lurchNotation' ) {
                    const converted = convertToLatex()
                    if ( converted !== null )
                        mathLiveInput.setValue( converted )
                    expressionIsValid = !!converted
                } else if ( component.name == 'latex' ) {
                    const converted = convertToLurchNotation()
                    if ( converted !== null )
                        dialog.dialog.setData( { lurchNotation : converted } )
                    expressionIsValid = !!converted
                }
            }
            if ( component.name == 'contentType' )
                showControlsForContentType( dialog.get( 'contentType' ) )
            if ( component.name != 'preview' ) {
                const preview = generatePreview()
                if ( preview )
                    mathLivePreview.setValue( preview )
                else
                    mathLivePreview.setValue( '' )
                dialog.dialog.setEnabled( 'OK', !!preview )
            }
            updatesEnabled = true
        }
        // Show it and if they accept any changes, apply them to the atom.
        const result = dialog.show().then( userHitOK => {
            if ( !userHitOK || !generatePreview() ) return false
            this.saveIntermediateModeData(
                dialog.get( 'contentType' ),
                dialog.get( 'symbol' ),
                dialog.get( 'latex' ),
                dialog.get( 'lurchNotation' )
            )
            this.update()
            return true
        } )
        showControlsForContentType( loadedData.contentType )
        const preview = generatePreview()
        if ( preview ) {
            const interval = setInterval( () => {
                if ( mathLivePreview.mathLiveEditor ) {
                    mathLivePreview.setValue( preview )
                    clearInterval( interval )
                }
            }, 25 )
        }
        dialog.dialog.setEnabled( 'OK', !!generatePreview() )
        return result
    }

    // Internal use only.
    // Used by edit() if the user's settings are in advanced mode.
    editInAdvancedMode () {
        const { lurchNotation } = this.loadAdvancedModeData()
        // set up dialog contents
        const dialog = new Dialog( 'Edit math', this.editor )
        dialog.hideHeader = dialog.hideFooter = true
        const lurchInput = new LongTextInputItem( 'lurchNotation', '', '' )
        dialog.addItem( lurchInput )
        const mathLivePreview = new MathItem( 'latex', '' )
        mathLivePreview.finishSetup = () => {
            mathLivePreview.mathLiveEditor.readOnly = true
            mathLivePreview.mathLiveEditor.style.border = 0
            mathLivePreview.mathLiveEditor.style.padding = '0.5rem 0 0 0.5rem'
        }
        dialog.addItem( mathLivePreview )
        // initialize dialog with data from the atom
        dialog.setInitialData( {
            lurchNotation : lurchNotation,
            latex : converter( lurchNotation, 'lurch', 'latex' )
        } )
        dialog.setDefaultFocus( 'lurchNotation' )
        // utility used below
        const convertToLatex = () => {
            try {
                return converter( dialog.get( 'lurchNotation' ), 'lurch', 'latex' )
            } catch {
                return null
            }
        }
        // if they edit the Lurch notation or latex, keep them in sync
        dialog.onChange = ( _, component ) => {
            if ( component.name == 'lurchNotation' ) {
                const converted = convertToLatex()
                if ( converted || converted === '' )
                    mathLivePreview.setValue( converted )
                const lurchInputElement = dialog.querySelector( 'textarea' )
                if ( lurchInputElement ) {
                    if ( typeof converted === 'string' ) {
                        lurchInputElement.classList.remove('badsyntax')
                    } else {
                        lurchInputElement.classList.add('badsyntax')
                    }
                }
                dialog.dialog.setEnabled( 'OK', !!converted )
            }
        }
        // Show it and if they accept any changes, apply them to the atom.
        const result = dialog.show().then( userHitOK => {
            if ( !userHitOK || !convertToLatex() ) return false
            this.saveAdvancedModeData( dialog.get( 'lurchNotation' ) )
            this.update()
            return true
        } )
        dialog.dialog.setEnabled( 'OK', !!convertToLatex() )
        // prevent enter to confirm if the input is invalid
        const lurchInputElement = dialog.querySelector( 'textarea' )
        if ( lurchInputElement ) {
            lurchInputElement.classList.add( 'advancedTextArea' )
            // set the initial height based on the number of current lines
            // of text in the initial value, plus wordwrap at 45 chars
            const computeHeight = s => 10 + 24 * Math.max( 1,
                s.split( '\n' ).reduce( ( total, line ) => 
                    total + Math.max( 1, Math.ceil( line.length / 45 ) ), 0 ) )
            lurchInputElement.style.height = computeHeight( lurchNotation ) + 'px'
            // it should be valid to start since it was saved in the first place
            lurchInputElement.classList.remove('badsyntax')

            // give it focus, but if it ever loses focus, close the dialog
            lurchInputElement.focus()
            lurchInputElement.addEventListener( 'blur', () =>
                setTimeout( () => dialog.close() ) )

            lurchInputElement.addEventListener('input', () =>
                lurchInputElement.style.height = 
                    computeHeight (lurchInputElement.value ) + 'px' )

            // listen for the Enter and Shift+Enter keys        
            lurchInputElement.addEventListener( 'keydown', event => {
                if ( event.key == 'Enter' ) {
                    if ( event.shiftKey ) {
                        // allow Shift+Enter to add a line
                    } else if ( convertToLatex() ) {
                        // Plain enter submits if the input is valid
                        dialog.querySelector( 'button[title="OK"]' ).click()
                    } else {
                        // Plain enter does nothing if the input is invalid
                        event.preventDefault()
                        event.stopPropagation()
                    }
                }
            } )
        }
        return result
    }

    /**
     * Shows a dialog for editing an expression atom, but it may show one of
     * three different dialogs, depending on whether the user has chosen
     * beginner, intermediate, or advanced mode in their settings.
     * 
     * **Beginner mode does this:**
     * 
     * Shows a dialog containing just a MathLive editor and a checkbox for
     * given/claim status.  The user can then confirm or cancel the edit, as
     * per the convention described in
     * {@link module:Atoms.Atom#edit the edit() function for the Atom class}.
     * 
     * **Intermediate mode does this:**
     * 
     * Shows a multi-part dialog for editing expression atoms using Lurch
     * notation or a MathLive editor widget.  The user can then confirm or
     * cancel the edit, as per the convention described in
     * {@link module:Atoms.Atom#edit the edit() function for the Atom class}.
     * 
     * **Advanced mode does this:**
     * 
     * The dialog is extremely minimalist, no title bar, no footer buttons, no
     * miniature headings over each input/output, and the only input is the
     * Lurch notation.  The MathLive widget is a read-only preview.  There is no
     * checkbox for given/claim status, but that status is inferred from the
     * Lurch notation.
     * 
     * @returns {Promise} same convention as specified in
     *   {@link module:Atoms.Atom#edit edit() for Atoms}
     */
    edit () {
        switch ( appSettings.get( 'expression editor type' ) ) {
            case 'Beginner':
                return this.editInBeginnerMode()
            case 'Intermediate':
                return this.editInIntermediateMode()
            case 'Advanced':
                return this.editInAdvancedMode()
        }
    }

    /**
     * The behavior of this function depends on whether the atom was last edited
     * using beginner mode, intermediate mode, or advanced mode.
     * 
     * If it was created using beginner mode, then we check to ensure that the
     * LaTeX version of the MathLive editor's contents represents a single
     * mathematical expression, optionally marked as an assumption.  If so, we
     * return an array containing just that expression (possibly marked as a
     * given).  If not, we return an empty array.
     * 
     * If it was created using intermediate mode, then it may represent a
     * statement (i.e., claim expression), an assumption (i.e., given
     * expression), or a declaration (of any of a variety of types, with or
     * without body).  As long as one of these holds true, we return a
     * JavaScript array containing the single LogicConcept represented by this
     * atom.  If not, we return an empty array.
     * 
     * If it was created using advanced mode, then we parse the Lurch notation
     * that was typed into the advanced mode dialog.  This will produce zero or
     * more LogicConcepts, in an array, which we return.
     * 
     * @returns {LogicConcept[]} an array containing zero or one LogicConcepts
     */
    toLCs () {
        const ensureOneExpression = LCs => {
            if ( LCs.message ) {
                console.log( 'Input did not parse:' )
                console.log( LCs.message )
                return [ ]
            }
            if ( LCs.length != 1 ) {
                console.log( 'Input yielded more than one LC:' )
                console.log( LCs.map( LC => LC.toPutdown() ) )
                return [ ]
            }
            if ( !( LCs[0] instanceof LCExpression ) ) {
                console.log( 'Input yielded a non-Expression LC:' )
                console.log( LCs[0].toPutdown() )
                return [ ]
            }
            return LCs
        }
        if ( this.isInBeginnerMode() ) {
            const { latex, given } = this.loadBeginnerModeData()
            if ( latex.trim() == '' ) return [ ]
            const lurchNotation = converter( latex, 'latex', 'lurch' )
            const prefix = given ? ':' : ''
            const result = parse( prefix + lurchNotation, 'lurchNotation' )
            return ensureOneExpression( result )
        }
        if ( this.isInIntermediateMode() ) {
            const { contentType, symbol, lurchNotation } = this.loadIntermediateModeData()
            if ( contentType == 'Statement' )
                return ensureOneExpression( parse( lurchNotation, 'lurchNotation' ) )
            if ( contentType == 'Assumption' )
                return ensureOneExpression(
                    parse( ':' + lurchNotation, 'lurchNotation' ) )
            const declType = DeclarationType.fromTemplate( contentType )
            if ( declType.body == 'none' )
                return [ declType.toLC( symbol ) ]
            const parsed = ensureOneExpression( parse( lurchNotation, 'lurchNotation' ) )
            if ( parsed.length == 0 ) return [ ]
            return [ declType.toLC( symbol, parsed[0] ) ]
        }
        if ( this.isInAdvancedMode() ) {
            const { lurchNotation } = this.loadAdvancedModeData()
            const ans = parse( lurchNotation, 'lurchNotation' )
            const results = this.getValidationResults()
            // there might be more than one result, e.g for transitive chains,
            // so show the worst one
            const result = 
                (results.includes('inapplicable')) ? 'inapplicable' :
                (results.includes('invalid')) ? 'invalid' :
                (results.includes('indeterminate')) ? 'indeterminate' :
                (results.includes('valid')) ? 'valid' : 'error'
            // if this atom produces only one LC expression, then assign its
            // ExpectedResult attribute.  If it produces multiple expressions
            // then we don't know which validation result in the span class came
            // from which LC so it is useless for testing.  
            if (results.length>0 &amp;&amp; ans.length==1) {
                ans.forEach( x => x.setAttribute('ExpectedResult',result) )
            }
            return ans
        }
    }

    /**
     * The behavior of this function depends on whether the atom was last edited
     * using beginner mode, intermediate mode, or advanced mode.
     * 
     * If it was created using beginner mode, then we place its HTML
     * representation in the body of the atom, and possibly place the word
     * "Assume" into the prefix of the atom, iff the atom is marked as an
     * assumption.  The atom suffix is not involved.
     * 
     * If it was created using intermediate mode and is a statement or
     * assumption, then we treat it as in beginner mode.  However, if it is a
     * declaration, we use {@link DeclarationType#documentForm documentForm()}
     * to convert it to HTML and use that as the body of the atom.  Any former
     * prefix in the atom is removed.  The atom suffix is not involved.
     * 
     * If it was created using advanced mode, then we apply a Lurch notation to
     * LaTeX conversion function, followed by a rendering of that LaTeX as HTML,
     * which goes into the body of the atom.  Any former prefix in the atom is
     * removed.  The atom suffix is not involved.
     */
    update () {
        const setContent = ( lurchNotation, given ) => {
            if ( given )
                this.fillChild( 'prefix', 'Assume ' )
            else
                this.removeChild( 'prefix' )
            const repr = `${represent( lurchNotation, 'lurchNotation' )}`
            this.fillChild( 'body', repr )
        }
        if ( this.isInBeginnerMode() ) {
            const { latex, given } = this.loadBeginnerModeData()
            setContent( converter( latex, 'latex', 'lurch' ), given )
        } else if ( this.isInIntermediateMode() ) {
            const { contentType, symbol, lurchNotation } = this.loadIntermediateModeData()
            if ( contentType == 'Statement' )
                setContent( lurchNotation, false )
            else if ( contentType == 'Assumption' )
                setContent( lurchNotation, true )
            else {
                const declType = DeclarationType.fromTemplate( contentType )
                const repr = `${represent( lurchNotation, 'lurchNotation' )}`
                this.fillChild( 'body', declType.documentForm( symbol, repr ) )
                this.removeChild( 'prefix' )
            }
        } else { // advanced mode
            const { lurchNotation } = this.loadAdvancedModeData()
            setContent( lurchNotation, false )
        }
    }

    /**
     * All atoms must be able to represent themselves in LaTeX form, so that the
     * document (or a portion of it) can be exporeted for use in a LaTeX editor,
     * such as Overleaf.  This function overrides the default implementation
     * with a representation suitable to expression atoms.  It wraps the LaTeX
     * representation of the expression in dollar signs.
     * 
     * @returns {string} LaTeX representation of an expression atom
     */
    toLatex () {
        const withPrefix = ( latex, given ) => {
            // Don't wrap in dollar signs if it's got an align or something:
            latex = /\\begin\{/.test( latex ) ? latex : `$${latex}$`
            return given ? 'Assume ' + latex : latex
        }
        if ( this.isInBeginnerMode() ) {
            const { latex, given } = this.loadBeginnerModeData()
            return withPrefix( latex, given )
        } else if ( this.isInIntermediateMode() ) {
            const { contentType, symbol, latex } = this.loadIntermediateModeData()
            if ( contentType == 'Statement' )
                return withPrefix( latex, false )
            if ( contentType == 'Assumption' )
                return withPrefix( latex, true )
            const declType = DeclarationType.fromTemplate( contentType )
            return declType.latexForm( symbol, latex )
        } else { // advanced mode
            const { lurchNotation } = this.loadAdvancedModeData()
            const latex = converter( lurchNotation, 'lurch', 'latex' )
            return withPrefix( latex, false )
        }
    }
    
    /**
     * Items to be included on the TinyMCE context menu if an atom of this class
     * is right-clicked.  For information on the format of the returned data,
     * see the TinyMCE v6 manual on custom context menus.
     * 
     * In this case, it adds one item, for viewing the meaning of the expression
     * in a pop-up dialog, either as a hierarchy of bullet points and sections,
     * or as a block of putdown code.
     * 
     * @param {Atom} forThis - the atom that received the right-click action that
     *   led to the creation of the context menu
     * @returns {Object[]} data representing the contents of a TinyMCE context
     *   menu
     */
    contextMenu ( forThis ) {
        const result = super.contextMenu( forThis )
        if ( forThis == this ) {
            result.unshift( {
                text : 'View meaning',
                onAction : () => Dialog.meaningOfAtom( this )
            } )
            result.unshift( {
                text : 'Copy expression',
                onAction : () => copyHTMLToClipboard( this.element.outerHTML )
            } )
        }
        return result
    }

    /**
     * When embedding a copy of the Lurch app in a larger page, users will want
     * to write simple HTML describing a Lurch document, then have a script
     * create a copy of the Lurch app and put that document into it.  We allow
     * for representing expressions using `&lt;lurch>...&lt;/lurch>` elements, which
     * contain Lurch notation.  This function can convert any expression atom
     * into the corresponding `lurch` element, as a string.
     * 
     * @returns {string} the representation of the atom as a `lurch` element
     */
    toEmbed () {
        const wrap = lurchNotation => `&lt;lurch>${lurchNotation}&lt;/lurch>`
        if ( this.isInBeginnerMode() ) {
            const { latex, given } = this.loadBeginnerModeData()
            if ( latex.trim() == '' ) return ''
            const lurchNotation = converter( latex, 'latex', 'lurch' )
            const prefix = given ? ':' : ''
            return wrap( prefix + lurchNotation )
        }
        if ( this.isInIntermediateMode() ) {
            const { contentType, symbol, lurchNotation } = this.loadIntermediateModeData()
            if ( contentType == 'Statement' ) return wrap( lurchNotation )
            if ( contentType == 'Assumption' ) return wrap( ':' + lurchNotation )
            const declType = DeclarationType.fromTemplate( contentType )
            return wrap( declType.lurchNotationForm( symbol, lurchNotation ) )
        }
        if ( this.isInAdvancedMode() ) {
            const { lurchNotation } = this.loadAdvancedModeData()
            return wrap( lurchNotation )
        }
    }

}

export default { install }
</code></pre>
    </article>
</section>




  </div>
</main>

<footer class="layout-footer">
  <div class="container">
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.3</a>
  </div>
</footer>



<script src="scripts/prism.dev.js"></script>
</body>
</html>
